{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid" style="padding-top: 80px;">
    <div class="container">
        <!-- Language Links -->
        <div class="text-center mb-3">
            <div class="btn-group btn-group-sm d-flex flex-wrap justify-content-center" role="group">
                <a href="/beneficios/" class="btn btn-outline-primary flex-fill mx-1 mb-2">üáßüá∑ Portugu√™s</a>
                <a href="/beneficios/de/" class="btn btn-outline-primary flex-fill mx-1 mb-2">üá©üá™ Deutsch</a>
                <a href="/beneficios/en/" class="btn btn-primary flex-fill mx-1 mb-2">üá∫üá∏ English</a>
            </div>
        </div>

        <!-- Hero Section -->
        <div class="jumbotron jumbotron-fluid text-white text-center" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); border-radius: 16px; box-shadow: 0 8px 32px rgba(0, 123, 255, 0.3);">
            <div class="container">
                <div class="mb-4">
                    <i class="fas fa-chart-line fa-4x mb-3" style="opacity: 0.9; color: white;"></i>
                </div>
                <h1 class="display-4 font-weight-bold mb-3 responsive-title" style="color: white !important;">Economic Analysis</h1>
                <p class="lead mb-4 responsive-subtitle" style="color: white !important;">Cost reduction and process optimization</p>
                
                <!-- Statistics Cards -->
                <div class="row justify-content-center">
                    <div class="col-lg-3 col-md-6 col-sm-6 col-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-1">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2 responsive-badge" style="font-size: 0.6rem; opacity: 0.9;">‚è∞ TIME SAVED</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">270.9h</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Per physician/year</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-1">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2 responsive-badge" style="font-size: 0.6rem; opacity: 0.9;">üí∞ ANNUAL SAVINGS</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">$8.9k</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Per physician</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-1">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2 responsive-badge" style="font-size: 0.6rem; opacity: 0.9;">üí∏ TOTAL SAVINGS</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.7rem; color: white !important;">$436k</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">10 physicians/5 years</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 col-sm-6 col-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-1">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2 responsive-badge" style="font-size: 0.6rem; opacity: 0.9;">‚úÖ EXPERIENCE</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">4 years</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Tested in practice</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Brazilian Healthcare Context Explanation -->
        <div class="card mb-4" style="border: 2px solid #17a2b8; background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);">
            <div class="card-body">
                <h4 class="card-title text-info mb-3">Brazilian Healthcare System Context</h4>
                <p class="mb-2"><strong>LME (Laudo para Solicita√ß√£o de Medicamento de Componente Especializado)</strong> = Prescription form for high-cost medications in the Brazilian public health system (SUS).</p>
                <p class="mb-2"><strong>High-cost pharmacies:</strong> Specialized government pharmacies that dispense expensive medications (often $1,000+ per month) for chronic conditions like Multiple Sclerosis, Epilepsy, and rare diseases at no cost to patients.</p>
                <p class="mb-2"><strong>The bureaucratic problem:</strong> Each LME form takes 17 minutes to complete manually and can extend over 10+ pages with extensive medical documentation requirements. Small errors in diagnosis codes, patient data, or medication details result in prescription rejection, forcing patients to return for new consultations.</p>
                <p class="mb-0"><strong>Critical impact:</strong> Manual completion creates significant administrative burden, reduces direct patient care time, and increases the risk of medication access delays due to bureaucratic errors.</p>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="card mb-4" style="border-left: 4px solid #007bff;">
            <div class="card-body" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
                <h3 class="card-title text-primary">Executive Summary</h3>
                <p class="card-text mb-3">CliqueReceita eliminates <strong>270.9 annual hours</strong> of medical bureaucracy, generating <strong>$8,866</strong> in savings per physician/year. Open-source system with <strong>4 years</strong> of proven clinical practice.</p>
                
                <div class="alert alert-info mb-3">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Real data:</strong> Collected from January 2019 to September 2023 in outpatient practice. Especially effective for specialties with high prescription volume (Neurology, Psychiatry, Endocrinology).
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-success h-100">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-piggy-bank mr-2"></i>Option 1: Direct Savings
                            </div>
                            <div class="card-body">
                                <p class="mb-0">Complete conversion to operational cost reduction</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-primary h-100">
                            <div class="card-header bg-primary text-white">
                                <i class="fas fa-users mr-2"></i>Option 2: Reinvestment
                            </div>
                            <div class="card-body">
                                <p class="mb-0">Care improvement: more professionals, shorter hours, longer consultations</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Operational Context -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">1. Operational Context</h3>
                <div class="alert alert-warning">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>The data below culminates in the 270.9 annual hours saved per physician presented in this analysis.</strong>
                </div>
                
                <div class="table-responsive mb-4">
                    <table class="table table-bordered table-hover">
                        <thead class="thead-light">
                            <tr>
                                <th>Item</th>
                                <th class="text-center">Before</th>
                                <th class="text-center">After</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Time to fill LME</strong></td>
                                <td class="text-center">17 min</td>
                                <td class="text-center">2 min (signature time only)</td>
                            </tr>
                            <tr>
                                <td><strong>Time savings per LME</strong></td>
                                <td class="text-center">‚Äì</td>
                                <td class="text-center"><strong>15 min</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Total LMEs filled/year</strong></td>
                                <td class="text-center">1,000</td>
                                <td class="text-center">1,000</td>
                            </tr>
                            <tr class="table-success">
                                <td><strong>Total time saved</strong></td>
                                <td class="text-center">‚Äì</td>
                                <td class="text-center"><strong>250 hours</strong><br><small class="text-muted">(15 min √ó 1,000 √∑ 60)</small></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="alert alert-info">
                    <i class="fas fa-plus mr-2"></i>
                    <strong>Additional time saved:</strong> Administrative time (20.9h) = <strong>20.9 extra hours</strong>
                </div>
                
                <div class="alert alert-success">
                    <i class="fas fa-calculator mr-2"></i>
                    <strong>Physician hourly wage:</strong> $32.7/hour
                </div>
                
                <ul class="list-unstyled">
                    <li class="mb-2"><i class="fas fa-users text-info mr-2"></i><strong>Number of regular patients:</strong> 400</li>
                    <li class="mb-2"><i class="fas fa-prescription text-info mr-2"></i><strong>Annual prescriptions:</strong> 1,000 (due to polypharmacy)</li>
                    <li class="mb-2"><i class="fas fa-exclamation-triangle text-warning mr-2"></i><strong>Incorrect prescription rate:</strong> 5% (50 per year)
                        <ul class="mt-2">
                            <li>Rate based on observed data. Example: CID G40 instead of G40.0 results in dispensing refusal.</li>
                            <li>Eliminates additional consultations just to reissue already completed prescriptions.</li>
                        </ul>
                    </li>
                    <li class="mb-2"><i class="fas fa-clock text-info mr-2"></i><strong>Additional administrative time saved:</strong>
                        <ul class="mt-2">
                            <li><strong>Extra consultations:</strong> 50 consultations √ó 20 min = 16.7 hours</li>
                            <li><strong>Rescheduling:</strong> 50 reschedules √ó 5 min = 4.2 hours</li>
                            <li><strong>Administrative total:</strong> 16.7h + 4.2h = <strong>20.9 hours/year</strong></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- ROI Section -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">2. Annual Financial Summary</h3>
                <div class="row justify-content-center mb-4">
                    <div class="col-lg-10">
                        <div class="card">
                            <div class="card-body">
                                <canvas id="roiChart" height="400"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-5 mb-3">
                        <div class="card border-success text-center">
                            <div class="card-body">
                                <h2 class="card-title text-success">$44,330</h2>
                                <p class="card-text">Savings in 5 years (1 physician)</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5 mb-3">
                        <div class="card border-primary text-center">
                            <div class="card-body">
                                <h2 class="card-title text-primary">$443,300</h2>
                                <p class="card-text">Savings in 5 years (10 physicians)</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card border-warning text-center">
                            <div class="card-body">
                                <h5 class="card-title text-warning">Conservative Scenario (50% of values)</h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <strong>1 physician:</strong> $22,165 (5 years)
                                    </div>
                                    <div class="col-md-6">
                                        <strong>10 physicians:</strong> $221,650 (5 years)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Demo Section -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary text-center mb-4">Process Demonstration</h3>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="embed-responsive embed-responsive-16by9" style="border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                            <video class="embed-responsive-item" controls style="object-fit: cover;">
                                <source src="{% static 'lme.mp4' %}" type="video/mp4">
                                Your browser does not support the video element.
                            </video>
                        </div>
                        <p class="text-center text-muted mt-3">
                            <i class="fas fa-play-circle mr-2"></i>
                            Demonstration video of automated LME filling
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Reduction of Rework -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">3. Reduction of Patient Burden</h3>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card border-warning h-100">
                            <div class="card-header bg-warning text-dark">
                                <i class="fas fa-exclamation-triangle mr-2"></i><strong>Clinical Risk Mitigation</strong>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-danger mb-2">
                                    <i class="fas fa-heart-broken mr-2"></i>
                                    <strong>Critical situations avoided:</strong>
                                    <ul class="mb-0 mt-2">
                                        <li>Abrupt discontinuation of antiepileptics (status epilepticus risk)</li>
                                        <li>Interruption of antipsychotics (psychiatric decompensation)</li>
                                        <li>Discontinuity of cardiac medications (cardiovascular events)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card border-success h-100">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-clock mr-2"></i><strong>Reduction of Patient Disruptions</strong>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <tbody>
                                            <tr>
                                                <td><strong>Incorrect prescriptions avoided:</strong></td>
                                                <td><span class="badge badge-success">50/year</span></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Time saved per patient:</strong></td>
                                                <td><span class="badge badge-info">1h</span></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Unnecessary extra consultations:</strong></td>
                                                <td><span class="badge badge-warning">50 avoided</span></td>
                                            </tr>
                                            <tr class="table-success">
                                                <td><strong>Total hours saved:</strong></td>
                                                <td><span class="badge badge-success">50h/year</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p class="text-muted mb-0">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <small>Eliminates unnecessary trips and pharmacy waiting times</small>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Benefits Flexibility -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">4. Flexibility in Benefits Application</h3>
                
                <div class="alert alert-success">
                    <h5 class="alert-heading">Direct Benefits:</h5>
                    <ul class="mb-0">
                        <li><strong>Improvement in care quality</strong> - physicians less burdened with bureaucracy can achieve greater focus and attention during consultations</li>
                        <li>Reduction of <strong>stress and burnout</strong> among professionals</li>
                        <li>More mental energy for complex clinical decisions</li>
                    </ul>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card border-info">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0">Option A - Financial Savings</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>Conversion to direct savings of $8,866/year per physician</li>
                                    <li>Ideal for institutions seeking budget optimization</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">Option B - Quality Investment</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>Extended consultation time</li>
                                    <li>Reduced workload while maintaining compensation</li>
                                    <li>Hiring additional team support</li>
                                    <li>Investment in training and infrastructure</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clinical Impact -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">5. Clinical Impact</h3>
                <div class="alert alert-warning">
                    <i class="fas fa-prescription-bottle-alt mr-2"></i>
                    <strong>Bureaucratic Barrier:</strong> Excessive bureaucracy creates barriers for prescribing high-cost medications, even when clinically indicated. Physicians often choose less effective alternatives to avoid complex bureaucratic processes, harming optimal patient care.
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-danger">
                            <div class="card-header bg-danger text-white">
                                <i class="fas fa-ban mr-2"></i>Current Scenario
                            </div>
                            <div class="card-body">
                                <ul class="mb-0">
                                    <li>17 minutes for each LME</li>
                                    <li>Avoidance of high-cost medications</li>
                                    <li>Suboptimal prescriptions for convenience</li>
                                    <li>Professional frustration</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-check mr-2"></i>With CliqueReceita
                            </div>
                            <div class="card-body">
                                <ul class="mb-0">
                                    <li>2 minutes (signature only)</li>
                                    <li>Evidence-based prescriptions</li>
                                    <li>Better therapeutic adherence</li>
                                    <li>Focus on patient care</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Security -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">6. Security</h3>
                <p>Periodic security analysis with audit systems and AI tools.</p>
                
                <p><strong>Implemented measures:</strong></p>
                <div class="list-group list-group-flush">
                    <div class="list-group-item"><i class="fas fa-shield-alt text-success mr-2"></i>Hardened OS (custom kernel modifications)</div>
                    <div class="list-group-item"><i class="fas fa-fire text-danger mr-2"></i>Firewall and SSH access only with cryptographic key</div>
                    <div class="list-group-item"><i class="fas fa-tachometer-alt text-warning mr-2"></i>Rate limiting and other protective measures</div>
                    <div class="list-group-item"><i class="fas fa-lock text-primary mr-2"></i>Data transmission exclusively encrypted</div>
                    <div class="list-group-item"><i class="fas fa-server text-info mr-2"></i>Security logs sent to external servers</div>
                    <div class="list-group-item"><i class="fas fa-memory text-secondary mr-2"></i>Ephemeral PDFs generated in RAM with access control</div>
                    <div class="list-group-item"><i class="fas fa-vial text-success mr-2"></i>Security testing during updates to ensure data isolation</div>
                </div>
                
                <div class="alert alert-info mt-3">
                    <i class="fas fa-balance-scale mr-2"></i>Compliance with <strong>GDPR and HIPAA</strong>.
                </div>
            </div>
        </div>

        <!-- Competitive Differentials -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">7. Competitive Differentials</h3>
                <p>Similar systems exist, however they don't have the comparable level of granularity and such efficient user interface - <strong>based on direct practical experience</strong> ‚Üí CliqueReceita is designed to have all conditional forms for each process, which will allow an administrative employee to issue reports <strong>without errors and without needing help</strong>.</p>
                
                <p>It's free software, <strong>open source</strong> (<a href="https://github.com/lcsavb/autocusto" target="_blank" class="text-primary">https://github.com/lcsavb/autocusto</a>), with <strong>GPL-3</strong> license (which allows commercial use, with the caveat that if integrated into another application, it must also have publicly available code). The in-house IT can perform <strong>local deployment</strong> of the app, considering the team works with the technology stack used (Django/Python/JS/Containers). Thus, data can be contained within the institution itself and the code modified for specific needs.</p>
            </div>
        </div>

        <!-- Roadmap -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">8. Roadmap</h3>
                <p>Next implementations: integrated electronic health record, AI patient intake system (pre-anamnesis), prescription system similar to MEMED/MEVO, as well as the possibility of <strong>digital signature of LMEs</strong> (enabling telemedicine).</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="card mb-5">
            <div class="card-body text-center text-muted">
                <p class="mb-0"><strong>Lucas Amorim Vieira de Barros</strong><br>
                CRM 150494</p>
            </div>
        </div>
    </div>
</div>

<style>
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Global text justification - exclude hero section */
.card-body p:not(.jumbotron *), .alert p, .list-unstyled li {
    text-align: justify !important;
}

/* Keep hero section text centered */
.jumbotron .card-text, .jumbotron p {
    text-align: center !important;
}

/* Ensure consistent card spacing */
.card {
    margin-bottom: 1.5rem !important;
}

.card:last-child {
    margin-bottom: 3rem !important;
}

/* Mobile-first responsive design */
@media (max-width: 576px) {
    /* Language buttons */
    .btn-group .btn {
        font-size: 0.8rem;
        padding: 0.5rem 0.75rem;
        margin: 0.25rem;
        min-width: 100px;
    }
    
    /* Hero section adjustments */
    .responsive-title {
        font-size: 2rem !important;
        line-height: 1.2;
    }
    
    .responsive-subtitle {
        font-size: 1rem !important;
        margin-bottom: 1.5rem !important;
    }
    
    /* Statistics cards mobile optimization */
    .responsive-badge {
        font-size: 0.5rem !important;
        padding: 0.2rem 0.4rem;
        display: block;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 100%;
    }
    
    .card-title {
        font-size: 1.4rem !important;
        margin-bottom: 0.5rem !important;
    }
    
    .card-text {
        font-size: 0.7rem !important;
        line-height: 1.2;
    }
    
    /* Container padding adjustments */
    .container-fluid {
        padding-left: 10px;
        padding-right: 10px;
    }
    
    /* Table responsive improvements */
    .table-responsive {
        font-size: 0.8rem;
    }
    
    .table th, .table td {
        padding: 0.5rem;
        font-size: 0.8rem;
    }
    
    /* Chart container */
    #roiChart {
        height: 300px !important;
    }
    
    /* Video container */
    .embed-responsive {
        margin-bottom: 1rem;
    }
    
    /* Card headers */
    .card-header {
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
    }
    
    /* Alert boxes */
    .alert {
        font-size: 0.8rem;
        padding: 0.5rem;
    }
    
    /* List items */
    .list-unstyled li {
        font-size: 0.8rem;
        margin-bottom: 0.5rem;
    }
}

@media (max-width: 768px) {
    .fa-arrow-right {
        transform: rotate(90deg);
        margin: 20px 0;
    }
    
    /* Medium screen adjustments */
    .responsive-title {
        font-size: 2.5rem !important;
    }
    
    .responsive-subtitle {
        font-size: 1.1rem !important;
    }
    
    .card-title {
        font-size: 1.6rem !important;
    }
}

@media (min-width: 576px) and (max-width: 768px) {
    /* Tablet specific adjustments */
    .responsive-badge {
        font-size: 0.6rem !important;
    }
    
    .btn-group .btn {
        font-size: 0.9rem;
        min-width: 120px;
    }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Wait for DOM to be fully loaded before initializing charts
let chartsInitialized = false;

function initCharts() {
    if (chartsInitialized) {
        return;
    }

// Updated ROI Chart with USD values
const roiChart = document.getElementById('roiChart');
if (roiChart) {
    const roiCtx = roiChart.getContext('2d');
    new Chart(roiCtx, {
        type: 'line',
        data: {
            labels: ['Year 0', 'Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5'],
            datasets: [{
                label: 'Cumulative Savings (1 physician - $8,866/year)',
                data: [-1818, 7048, 15914, 24780, 33646, 42512],
                borderColor: '#007bff',
                backgroundColor: 'rgba(0, 123, 255, 0.1)',
                borderWidth: 3,
                tension: 0.4,
                pointBackgroundColor: '#007bff'
            }, {
                label: 'Cumulative Savings (10 physicians)',  
                data: [-5455, 88660, 182775, 276890, 371005, 465120],
                borderColor: '#28a745',
                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                borderWidth: 3,
                tension: 0.4,
                pointBackgroundColor: '#28a745'
            }, {
                label: 'Conservative Scenario (1 physician - 50%)',
                data: [-909, 3524, 7957, 12390, 16823, 21256],
                borderColor: '#ffc107',
                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                borderWidth: 2,
                tension: 0.4,
                borderDash: [5, 5],
                pointBackgroundColor: '#ffc107'
            }, {
                label: 'Conservative Scenario (10 physicians - 50%)',
                data: [-2727, 44330, 91387, 138445, 185502, 232560],
                borderColor: '#fd7e14',
                backgroundColor: 'rgba(253, 126, 20, 0.1)',
                borderWidth: 2,
                tension: 0.4,
                borderDash: [10, 5],
                pointBackgroundColor: '#fd7e14'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
                duration: 2000,
                easing: 'easeOutCubic',
                delay: (context) => context.dataIndex * 300,
                animateRotate: true,
                animateScale: true
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return '$' + value.toLocaleString('en-US');
                        }
                    }
                }
            },
            plugins: {
                legend: {
                    display: true,
                    position: 'bottom',
                    labels: {
                        usePointStyle: true,
                        padding: 20,
                        font: {
                            size: 12
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.dataset.label + ': $' + context.parsed.y.toLocaleString('en-US');
                        }
                    }
                }
            }
        }
    });
}

chartsInitialized = true;
}

// Try multiple ways to ensure charts load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCharts);
} else {
    initCharts();
}
window.addEventListener('load', initCharts);
</script>
{% endblock %}