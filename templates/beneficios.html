{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="container-fluid" style="padding-top: 80px;">
    <div class="container">
        <!-- Hero Section -->
        <div class="jumbotron jumbotron-fluid text-white text-center" style="background: linear-gradient(135deg, #007bff 0%, #0056b3 100%); border-radius: 16px; box-shadow: 0 8px 32px rgba(0, 123, 255, 0.3);">
            <div class="container">
                <div class="mb-4">
                    <i class="fas fa-chart-line fa-4x mb-3" style="opacity: 0.9; color: white;"></i>
                </div>
                <h1 class="display-4 font-weight-bold mb-3" style="color: white !important;">An√°lise Econ√¥mica</h1>
                <p class="lead mb-5" style="color: white !important;">Redu√ß√£o de custos e otimiza√ß√£o de processos</p>
                
                <!-- Statistics Cards -->
                <div class="row justify-content-center">
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-2">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2" style="font-size: 0.7rem; opacity: 0.9;">‚è∞ TEMPO POUPADO</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">270,9h</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Por m√©dico/ano</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-2">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2" style="font-size: 0.7rem; opacity: 0.9;">üí∞ ECONOMIA ANUAL</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">R$ 49k</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Por m√©dico</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-2">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2" style="font-size: 0.7rem; opacity: 0.9;">üí∏ ECONOMIA TOTAL</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.7rem; color: white !important;">R$ 2,4M</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">10 m√©dicos/5 anos</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-4 col-sm-6 mb-3">
                        <div class="card border-0 h-100" style="background: rgba(255,255,255,0.25); backdrop-filter: blur(10px); border-radius: 12px; min-height: 120px;">
                            <div class="card-body text-center d-flex flex-column justify-content-center px-2">
                                <div class="mb-2">
                                    <span class="badge badge-light mb-2" style="font-size: 0.7rem; opacity: 0.9;">‚úÖ EXPERI√äNCIA</span>
                                </div>
                                <h2 class="card-title mb-1 font-weight-bold" style="font-size: 1.8rem; color: white !important;">4 anos</h2>
                                <p class="card-text mb-0" style="font-size: 0.8rem; color: white !important; opacity: 0.9;">Testado na pr√°tica</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Executive Summary -->
        <div class="card mb-4" style="border-left: 4px solid #007bff;">
            <div class="card-body" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);">
                <h3 class="card-title text-primary">Resumo Executivo</h3>
                <p class="card-text mb-3">O CliqueReceita elimina <strong>270,9 horas anuais</strong> de burocracia m√©dica, gerando <strong>R$ 48.762</strong> em economia por m√©dico/ano. Sistema open source com <strong>4 anos</strong> de pr√°tica cl√≠nica comprovada.</p>
                
                <div class="alert alert-info mb-3">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Dados reais:</strong> Coletados de Janeiro/2019 a Setembro/2023 em pr√°tica ambulatorial. Especialmente eficaz para especialidades com alto volume de prescri√ß√µes (Neurologia, Psiquiatria, Endocrinologia).
                </div>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-success h-100">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-piggy-bank mr-2"></i>Op√ß√£o 1: Economia Direta
                            </div>
                            <div class="card-body">
                                <p class="mb-0">Convers√£o total em redu√ß√£o de custos operacionais</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-primary h-100">
                            <div class="card-header bg-primary text-white">
                                <i class="fas fa-users mr-2"></i>Op√ß√£o 2: Reinvestimento
                            </div>
                            <div class="card-body">
                                <p class="mb-0">Melhoria assistencial: mais profissionais, menor carga hor√°ria, consultas mais longas</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Operational Context -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">1. Contexto Operacional</h3>
                <div class="alert alert-warning">
                    <i class="fas fa-info-circle mr-2"></i>
                    <strong>Os dados abaixo culminam nas 303,9 horas anuais economizadas por m√©dico apresentadas nesta an√°lise.</strong>
                </div>
                
                <div class="table-responsive mb-4">
                    <table class="table table-bordered table-hover">
                        <thead class="thead-light">
                            <tr>
                                <th>Item</th>
                                <th class="text-center">Antes</th>
                                <th class="text-center">Depois</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Tempo para preenchimento de LME</strong></td>
                                <td class="text-center">17 min</td>
                                <td class="text-center">2 min (apenas tempo para assinatura)</td>
                            </tr>
                            <tr>
                                <td><strong>Economia de tempo por LME</strong></td>
                                <td class="text-center">‚Äì</td>
                                <td class="text-center"><strong>15 min</strong></td>
                            </tr>
                            <tr>
                                <td><strong>Total de LMEs preenchidas/ano</strong></td>
                                <td class="text-center">1.000</td>
                                <td class="text-center">1.000</td>
                            </tr>
                            <tr class="table-success">
                                <td><strong>Tempo total economizado</strong></td>
                                <td class="text-center">‚Äì</td>
                                <td class="text-center"><strong>250 horas</strong><br><small class="text-muted">(15 min √ó 1.000 √∑ 60)</small></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="alert alert-info">
                    <i class="fas fa-plus mr-2"></i>
                    <strong>Tempo adicional economizado:</strong> Tempo administrativo (20,9h) = <strong>20,9 horas extras</strong>
                </div>
                
                <ul class="list-unstyled">
                    <li class="mb-2"><i class="fas fa-users text-info mr-2"></i><strong>N√∫mero de pacientes regulares:</strong> 400</li>
                    <li class="mb-2"><i class="fas fa-prescription text-info mr-2"></i><strong>Prescri√ß√µes anuais:</strong> 1.000 (devido √† polimedica√ß√£o)</li>
                    <li class="mb-2"><i class="fas fa-exclamation-triangle text-warning mr-2"></i><strong>Taxa de prescri√ß√µes incorretas:</strong> 5% (50 por ano)
                        <ul class="mt-2">
                            <li>Taxa baseada em dados observados. Exemplo: CID G40 ao inv√©s de G40.0 resulta em recusa na dispensa√ß√£o.</li>
                            <li>Elimina-se consultas adicionais apenas para reemitir prescri√ß√µes j√° realizadas.</li>
                        </ul>
                    </li>
                    <li class="mb-2"><i class="fas fa-clock text-info mr-2"></i><strong>Tempo administrativo adicional economizado:</strong>
                        <ul class="mt-2">
                            <li><strong>Consultas extras:</strong> 50 consultas √ó 20 min = 16,7 horas</li>
                            <li><strong>Remarca√ß√µes:</strong> 50 remarca√ß√µes √ó 5 min = 4,2 horas</li>
                            <li><strong>Total administrativo:</strong> 16,7h + 4,2h = <strong>20,9 horas/ano</strong></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>

        <!-- ROI Section -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">2. Resumo Financeiro Anual</h3>
                <h4 class="text-center mb-4">Retorno sobre Investimento (ROI) - Proje√ß√£o 5 Anos</h4>
                <div class="row justify-content-center mb-4">
                    <div class="col-lg-10">
                        <div class="card">
                            <div class="card-body">
                                <canvas id="roiChart" height="400"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-5 mb-3">
                        <div class="card border-success text-center">
                            <div class="card-body">
                                <h2 class="card-title text-success">R$ 243.810</h2>
                                <p class="card-text">Economia em 5 anos (1 m√©dico)</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-5 mb-3">
                        <div class="card border-primary text-center">
                            <div class="card-body">
                                <h2 class="card-title text-primary">R$ 2.438.100</h2>
                                <p class="card-text">Economia em 5 anos (10 m√©dicos)</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-md-10">
                        <div class="card border-warning text-center">
                            <div class="card-body">
                                <h5 class="card-title text-warning">Cen√°rio Conservador (50% dos valores)</h5>
                                <div class="row">
                                    <div class="col-md-6">
                                        <strong>1 m√©dico:</strong> R$ 121.905 (5 anos)
                                    </div>
                                    <div class="col-md-6">
                                        <strong>10 m√©dicos:</strong> R$ 1.219.050 (5 anos)
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Video Demo Section -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary text-center mb-4">Demonstra√ß√£o do Processo</h3>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="embed-responsive embed-responsive-16by9" style="border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                            <video class="embed-responsive-item" controls style="object-fit: cover;">
                                <source src="{% static 'lme.mp4' %}" type="video/mp4">
                                Seu navegador n√£o suporta o elemento de v√≠deo.
                            </video>
                        </div>
                        <p class="text-center text-muted mt-3">
                            <i class="fas fa-play-circle mr-2"></i>
                            V√≠deo demonstrativo do preenchimento automatizado de LMEs
                        </p>
                    </div>
                </div>
            </div>
        </div>


        <!-- Reduction of Rework -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">3. Redu√ß√£o de Transtorno para Pacientes</h3>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card border-warning h-100">
                            <div class="card-header bg-warning text-dark">
                                <i class="fas fa-exclamation-triangle mr-2"></i><strong>Mitiga√ß√£o de Riscos Cl√≠nicos</strong>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-danger mb-2">
                                    <i class="fas fa-heart-broken mr-2"></i>
                                    <strong>Situa√ß√µes cr√≠ticas evitadas:</strong>
                                    <ul class="mb-0 mt-2">
                                        <li>Suspens√£o abrupta de antiepil√©pticos (risco de status epilepticus)</li>
                                        <li>Interrup√ß√£o de antipsic√≥ticos (descompensa√ß√£o psiqui√°trica)</li>
                                        <li>Descontinuidade de medica√ß√µes cardiol√≥gicas (eventos cardiovasculares)</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card border-success h-100">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-clock mr-2"></i><strong>Redu√ß√£o de de transtornos para pacientes</strong>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-sm">
                                        <tbody>
                                            <tr>
                                                <td><strong>Prescri√ß√µes incorretas evitadas:</strong></td>
                                                <td><span class="badge badge-success">50/ano</span></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Tempo poupado por paciente:</strong></td>
                                                <td><span class="badge badge-info">1h</span></td>
                                            </tr>
                                            <tr>
                                                <td><strong>Consultas extras desnecess√°rias:</strong></td>
                                                <td><span class="badge badge-warning">50 evitadas</span></td>
                                            </tr>
                                            <tr class="table-success">
                                                <td><strong>Total de horas poupadas:</strong></td>
                                                <td><span class="badge badge-success">50h/ano</span></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <p class="text-muted mb-0">
                                    <i class="fas fa-info-circle mr-2"></i>
                                    <small>Elimina deslocamentos desnecess√°rios e tempo em filas de farm√°cia</small>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Benefits Flexibility -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">4. Flexibilidade na Aplica√ß√£o dos Benef√≠cios</h3>
                
                <div class="alert alert-success">
                    <h5 class="alert-heading">Benef√≠cios Diretos:</h5>
                    <ul class="mb-0">
                        <li><strong>Melhoria na qualidade do atendimento</strong> - m√©dicos menos sobrecarregados com burocracia conseguem maior foco e aten√ß√£o durante as consultas</li>
                        <li>Redu√ß√£o do <strong>estresse e burnout</strong> profissional</li>
                        <li>Mais energia mental para decis√µes cl√≠nicas complexas</li>
                    </ul>
                </div>
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <div class="card border-info">
                            <div class="card-header bg-info text-white">
                                <h5 class="mb-0">Op√ß√£o A - Economia Financeira</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>Convers√£o em economia direta de R$ 48.762/ano por m√©dico</li>
                                    <li>Ideal para institui√ß√µes que buscam otimiza√ß√£o or√ßament√°ria</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mb-3">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <h5 class="mb-0">Op√ß√£o B - Investimento em Qualidade</h5>
                            </div>
                            <div class="card-body">
                                <ul>
                                    <li>Amplia√ß√£o do tempo de consulta</li>
                                    <li>Redu√ß√£o da carga hor√°ria mantendo a remunera√ß√£o</li>
                                    <li>Contrata√ß√£o de apoio adicional para a equipe</li>
                                    <li>Investimento em capacita√ß√£o e infraestrutura</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Clinical Impact -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">5. Impacto Cl√≠nico</h3>
                <div class="alert alert-warning">
                    <i class="fas fa-prescription-bottle-alt mr-2"></i>
                    <strong>Barreira Burocr√°tica:</strong> A burocracia excessiva cria barreira para prescri√ß√µes de medica√ß√µes de alto custo, mesmo quando clinicamente indicadas. M√©dicos frequentemente optam por alternativas menos eficazes para evitar processos burocr√°ticos complexos, prejudicando o cuidado ideal dos pacientes.
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <div class="card border-danger">
                            <div class="card-header bg-danger text-white">
                                <i class="fas fa-ban mr-2"></i>Cen√°rio Atual
                            </div>
                            <div class="card-body">
                                <ul class="mb-0">
                                    <li>17 minutos para cada LME</li>
                                    <li>Evita√ß√£o de medica√ß√µes de alto custo</li>
                                    <li>Prescri√ß√µes sub√≥timas por conveni√™ncia</li>
                                    <li>Frustra√ß√£o profissional</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card border-success">
                            <div class="card-header bg-success text-white">
                                <i class="fas fa-check mr-2"></i>Com CliqueReceita
                            </div>
                            <div class="card-body">
                                <ul class="mb-0">
                                    <li>2 minutos (apenas assinatura)</li>
                                    <li>Prescri√ß√µes baseadas em evid√™ncia</li>
                                    <li>Melhor ader√™ncia terap√™utica</li>
                                    <li>Foco no cuidado do paciente</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Security -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">6. Seguran√ßa</h3>
                <p>An√°lise de seguran√ßa peri√≥dica com sistemas de auditoria e ferramentas de IA.</p>
                
                <p><strong>Medidas implementadas:</strong></p>
                <div class="list-group list-group-flush">
                    <div class="list-group-item"><i class="fas fa-shield-alt text-success mr-2"></i>OS hardened (altera√ß√µes customizadas no kernel)</div>
                    <div class="list-group-item"><i class="fas fa-fire text-danger mr-2"></i>Firewall e acesso SSH apenas com chave criptogr√°fica</div>
                    <div class="list-group-item"><i class="fas fa-tachometer-alt text-warning mr-2"></i>Rate limiting e outras medidas de prote√ß√£o</div>
                    <div class="list-group-item"><i class="fas fa-lock text-primary mr-2"></i>Transmiss√£o de dados exclusivamente criptografada</div>
                    <div class="list-group-item"><i class="fas fa-server text-info mr-2"></i>Logs de seguran√ßa enviados para servidores externos</div>
                    <div class="list-group-item"><i class="fas fa-memory text-secondary mr-2"></i>PDFs ef√™meros gerados na mem√≥ria RAM com controle de acesso</div>
                    <div class="list-group-item"><i class="fas fa-vial text-success mr-2"></i>Testes de seguran√ßa durante atualiza√ß√µes para garantir isolamento de dados</div>
                </div>
                
                <div class="alert alert-info mt-3">
                    <i class="fas fa-balance-scale mr-2"></i>Conformidade com <strong>LGPD e HIPAA</strong>.
                </div>
            </div>
        </div>

        <!-- Competitive Differentials -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">7. Diferenciais Competitivos</h3>
                <p>Existem sistemas semelhantes, todavia eles n√£o tem o n√≠vel de granularidade compar√°vel e a interface do usu√°rio t√£o eficiente - <strong>baseado em experi√™ncia pr√°tica direta</strong> ‚Üí o CliqueReceita √© projetado para ter todos os formul√°rios condicionais de cada processo, o que permitir√° que um funcion√°rio administrativo emita os laudos <strong>sem erros e sem precisar de ajuda</strong>.</p>
                
                <p>Trata-se de software livre, <strong>open source</strong> (<a href="https://github.com/lcsavb/autocusto" target="_blank" class="text-primary">https://github.com/lcsavb/autocusto</a>), com licen√ßa <strong>GPL-3</strong> (que permite o uso comercial, com a ressalva que se for integrado a outra aplica√ß√£o, esta precisa tamb√©m ter o c√≥digo publicamente dispon√≠vel). A TI pr√≥pria pode fazer o <strong>deploy local</strong> do app, considerando que a equipe trabalhe com o stack de tecnologias utilizadas (Django/Python/JS/Containers). Assim, os dados podem ser contidos na pr√≥pria institui√ß√£o e o c√≥digo modificado para necessidades espec√≠ficas.</p>
                
            </div>
        </div>

        <!-- Roadmap -->
        <div class="card mb-4">
            <div class="card-body">
                <h3 class="card-title text-primary">8. Roadmap</h3>
                <p>Pr√≥ximas implementa√ß√µes: prontu√°rio eletr√¥nico integrado, sistema de IA de intake de paciente (pr√©-anamnese), sistema de prescri√ß√µes de receitas similar ao MEMED/MEVO, assim como a possibilidade de <strong>assinatura digital das LMEs</strong> (propiciando a avia√ß√£o por telemedicina).</p>
            </div>
        </div>

        <!-- Footer -->
        <div class="card mb-5">
            <div class="card-body text-center text-muted">
                <p class="mb-0"><strong>Lucas Amorim Vieira de Barros</strong><br>
                CRM 150494</p>
            </div>
        </div>
    </div>
</div>

<style>
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

@media (max-width: 768px) {
    .fa-arrow-right {
        transform: rotate(90deg);
        margin: 20px 0;
    }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// Wait for DOM to be fully loaded before initializing charts
let chartsInitialized = false;

function initCharts() {
    if (chartsInitialized) {
        return;
    }

// Updated ROI Chart with correct values
const roiChart = document.getElementById('roiChart');
if (roiChart) {
    const roiCtx = roiChart.getContext('2d');
    new Chart(roiCtx, {
        type: 'line',
        data: {
            labels: ['Ano 0', 'Ano 1', 'Ano 2', 'Ano 3', 'Ano 4', 'Ano 5'],
            datasets: [{
                label: 'Economia Acumulada (1 m√©dico - R$ 48.762/ano)',
                data: [-10000, 38762, 87524, 136286, 185048, 233810],
                borderColor: '#007bff',
                backgroundColor: 'rgba(0, 123, 255, 0.1)',
                borderWidth: 3,
                tension: 0.4,
                pointBackgroundColor: '#007bff'
            }, {
                label: 'Economia Acumulada (10 m√©dicos)',  
                data: [-30000, 487620, 1005240, 1522860, 2040480, 2558100],
                borderColor: '#28a745',
                backgroundColor: 'rgba(40, 167, 69, 0.1)',
                borderWidth: 3,
                tension: 0.4,
                pointBackgroundColor: '#28a745'
            }, {
                label: 'Cen√°rio Conservador (1 m√©dico - 50%)',
                data: [-5000, 19381, 43762, 68143, 92524, 116905],
                borderColor: '#ffc107',
                backgroundColor: 'rgba(255, 193, 7, 0.1)',
                borderWidth: 2,
                tension: 0.4,
                borderDash: [5, 5],
                pointBackgroundColor: '#ffc107'
            }, {
                label: 'Cen√°rio Conservador (10 m√©dicos - 50%)',
                data: [-15000, 243810, 502620, 761430, 1020240, 1279050],
                borderColor: '#fd7e14',
                backgroundColor: 'rgba(253, 126, 20, 0.1)',
                borderWidth: 2,
                tension: 0.4,
                borderDash: [10, 5],
                pointBackgroundColor: '#fd7e14'
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            animation: {
                duration: 2000,
                easing: 'easeOutCubic',
                delay: (context) => context.dataIndex * 300,
                animateRotate: true,
                animateScale: true
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        callback: function(value) {
                            return 'R$ ' + value.toLocaleString('pt-BR');
                        }
                    }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            return context.dataset.label + ': R$ ' + context.parsed.y.toLocaleString('pt-BR');
                        }
                    }
                }
            }
        }
    });
}

// Pie Chart (if it exists)
const pieCtx = document.getElementById('pieChart');
if (pieCtx) {
new Chart(pieCtx, {
    type: 'doughnut',
    data: {
        labels: ['Preenchimento LME', 'Tempo administrativo'],
        datasets: [{
            data: [250, 20.9],
            backgroundColor: ['#007bff', '#28a745'],
            borderWidth: 4,
            borderColor: '#fff',
            hoverBorderWidth: 6,
            hoverOffset: 8
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        cutout: '50%',
        plugins: {
            legend: { display: false },
            tooltip: {
                backgroundColor: 'rgba(0,0,0,0.8)',
                callbacks: {
                    label: function(context) {
                        const value = context.parsed;
                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                        const percentage = Math.round((value / total) * 100);
                        return [
                            `${value} horas anuais`,
                            `${percentage}% do total`,
                            `R$ ${(value * 180).toLocaleString('pt-BR')} em valor`
                        ];
                    }
                }
            }
        },
        animation: {
            duration: 2000,
            easing: 'easeOutCubic',
            delay: (context) => context.dataIndex * 300
        }
    }
});
}

chartsInitialized = true;

// End of initCharts function  
}

// Try multiple ways to ensure charts load
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initCharts);
} else {
    initCharts();
}
window.addEventListener('load', initCharts);
</script>
{% endblock %}